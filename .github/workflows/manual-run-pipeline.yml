name: Manual Test Run # Название пайплайна

on:
  workflow_dispatch: # Этот триггер позволяет запускать пайплайн вручную

jobs: # Список работ
  run-tests: # Название работы
    runs-on: ubuntu-latest # На какой ОС запускать
    steps: # Шаги, которые нужно выполнить
        - uses: actions/checkout@v4 # 1. Клонирование репозитория

        - name: Set up Node.js
          uses: actions/setup-node@v4
          with:
            node-version: '22.x' # 2. Устанавливаем Node.js

        - name: Install dependencies
          run: npm install # 3. Установка зависимостей

        - name: Install Playwright Browsers
          run: npx playwright install --with-deps # 4. Установка браузеров Playwright

        - name: Run Playwright tests 
          run: npx playwright test # 5. Запуск тестов

        - name: Upload report # 6. Загрузка отчетов (Artifacts)
          if: always()
          uses: actions/upload-artifact@v4
          with:
            name: playwright-report
            path: playwright-report/
            retention-days: 7